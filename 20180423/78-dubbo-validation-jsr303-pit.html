<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-113235655-1', 'auto');
ga('send', 'pageview');
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<!-- End Google Analytics -->


    

    
<!-- Baidu Tongji -->
<script>var _hmt = _hmt || []</script>
<script async src="//hm.baidu.com/hm.js?83434579b8f6b6a6c80fd1b4fe2d9afa"></script>
<!-- End Baidu Tongji -->




    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="tyyr-WLO-Sq85TjMOOOHRRc5YD4W8if8mCXbUD_p_7k">
    
    
    <meta name="sogou_site_verification" content="PlW7T4UKFR">
    
    
    <meta name="baidu-site-verification" content="AdjyK6UssW">
    
    
    <meta name="msvalidate.01" content="BC20DDADC069448DFBCA67D9D7D57546">
    
    
    <meta name="360-site-verification" content="3addb98f1fb5f6b4d1ce03efc23bf5b8">
    
    
    
    <title>Dubbo使用jsr303框架hibernate-validator遇到的问题 | 凝雨 - Yun | 快乐编程每一天 - Happy Coding Every Day</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="dubbo,jsr303,hibernate-validator">
    <meta name="description" content="Dubbo使用jsr303框架hibernate-validator遇到的问题">
<meta name="keywords" content="dubbo,jsr303,hibernate-validator">
<meta property="og:type" content="article">
<meta property="og:title" content="Dubbo使用jsr303框架hibernate-validator遇到的问题">
<meta property="og:url" content="https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html">
<meta property="og:site_name" content="凝雨 - Yun">
<meta property="og:description" content="Dubbo使用jsr303框架hibernate-validator遇到的问题">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2024-04-23T01:48:15.037Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dubbo使用jsr303框架hibernate-validator遇到的问题">
<meta name="twitter:description" content="Dubbo使用jsr303框架hibernate-validator遇到的问题">
    
        <link rel="alternate" type="application/atom+xml" title="凝雨 - Yun" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">凝雨</h5>
          <a href="mailto:ningbe111@163.com" title="ningbe111@163.com" class="mail">ningbe111@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Home
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives/"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories/"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags/"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/ningyu1" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about/"  >
                <i class="icon icon-lg icon-user"></i>
                About
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/atom.xml" target="_blank" >
                <i class="icon icon-lg icon-rss"></i>
                Rss
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://g2.okk.dog/?path=register&code=qn7nOwdj" target="_blank" >
                <i class="icon icon-lg icon-rocket"></i>
                科学上网
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Dubbo使用jsr303框架hibernate-validator遇到的问题</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Dubbo使用jsr303框架hibernate-validator遇到的问题</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-04-23T05:25:00.000Z" itemprop="datePublished" class="page-time">
  2018-04-23
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/dubbo/">dubbo</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>文章目录</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#问题描述"><span class="post-toc-number">1.</span> <span class="post-toc-text">问题描述</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#当我们在consumer端开启验证时"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">当我们在consumer端开启验证时:</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#当我们在provider端开启验证时："><span class="post-toc-number">1.2.</span> <span class="post-toc-text">当我们在provider端开启验证时：</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#问题分析"><span class="post-toc-number">2.</span> <span class="post-toc-text">问题分析</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#解决方案"><span class="post-toc-number">3.</span> <span class="post-toc-text">解决方案</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#方法一：使用无参构造方法来创建对象"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">方法一：使用无参构造方法来创建对象</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#方法二：替换jsr303实现框架"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">方法二：替换jsr303实现框架</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#方法三：修改hibernate-validator的原声类，修改Dubbo-ValidationFilter，这也是我最终采用的方法"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">方法三：修改hibernate-validator的原声类，修改Dubbo ValidationFilter，这也是我最终采用的方法</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#增加类：DubboConstraintViolation实现javax-validation-ConstraintViolation接口"><span class="post-toc-number">3.3.1.</span> <span class="post-toc-text">增加类：DubboConstraintViolation实现javax.validation.ConstraintViolation接口</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#修改com-alibaba-dubbo-validation-filter-ValidationFilter异常处理的部分"><span class="post-toc-number">3.3.2.</span> <span class="post-toc-text">修改com.alibaba.dubbo.validation.filter.ValidationFilter异常处理的部分</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#总结"><span class="post-toc-number">4.</span> <span class="post-toc-text">总结</span></a></li></ol>
        </nav>
    </aside>


<article id="post-78-dubbo-validation-jsr303-pit"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Dubbo使用jsr303框架hibernate-validator遇到的问题</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-04-23 13:25:00" datetime="2018-04-23T05:25:00.000Z"  itemprop="datePublished">2018-04-23</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/dubbo/">dubbo</a></li></ul>



            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <p><code>Dubbo</code>可以集成jsr303标准规范的验证框架，作为验证框架不二人选的<code>hibernate-validator</code>是大家都会经常在项目中使用的，但是在<code>Dubbo</code>使用是会发生下面这个问题。</p>
<h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>背景：使用<code>springmvc</code>做<code>restful</code>，使用<code>dubbo</code>做rpc，<code>restful</code>中调用大量的rpc，数据验证会在这两个地方，一个是<code>restful</code>层面，一个是rpc层面，<code>restful</code>层面使用<code>springmvc</code>默认的集成<code>hibernate-validator</code>来实现，参数开启验证只需要加入<code>@Validated param</code>。</p>
<p>rpc层面也使用<code>hibernate-validator</code>实现，dubbo中开启validation也有两个方式，一个是在<code>consumer</code>端，一个是在<code>provider</code>端。</p>
<h2 id="当我们在consumer端开启验证时"><a href="#当我们在consumer端开启验证时" class="headerlink" title="当我们在consumer端开启验证时:"></a>当我们在consumer端开启验证时:</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dubbo:reference id=&quot;serviceName&quot; interface=&quot;com.domain.package.TestService&quot; registry=&quot;registry&quot; validation=&quot;true&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>没有任何问题，可以拿到所有的数据校验失败数据。</p>
<h2 id="当我们在provider端开启验证时："><a href="#当我们在provider端开启验证时：" class="headerlink" title="当我们在provider端开启验证时："></a>当我们在provider端开启验证时：</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dubbo:service interface=&quot;com.domain.package.TestService&quot; ref=&quot;serviceName&quot; validation=&quot;true&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>会发生如下异常：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">com.alibaba.dubbo.rpc.RpcException: Failed to invoke remote method: sayHello, provider: </span><br><span class="line"></span><br><span class="line">dubbo://127.0.0.1:20831/com.domain.package.TestService?application=dubbo-test-</span><br><span class="line"></span><br><span class="line">rest&amp;default.check=false&amp;default.cluster=failfast&amp;default.retries=0&amp;default.timeout=1200000&amp;default.version=1.0</span><br><span class="line"></span><br><span class="line">.0&amp;dubbo=2.6.1&amp;interface=com.domain.package.TestService&amp;methods=sayHello&amp;pid=29268&amp;register.ip=192.</span><br><span class="line"></span><br><span class="line">168.6.47&amp;side=consumer&amp;timestamp=1524453157718, cause: com.alibaba.com.caucho.hessian.io.HessianFieldException: </span><br><span class="line"></span><br><span class="line">org.hibernate.validator.internal.engine.ConstraintViolationImpl.constraintDescriptor: </span><br><span class="line"></span><br><span class="line">&apos;org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl&apos; could not be instantiated</span><br><span class="line">com.alibaba.com.caucho.hessian.io.HessianFieldException: </span><br><span class="line"></span><br><span class="line">org.hibernate.validator.internal.engine.ConstraintViolationImpl.constraintDescriptor: </span><br><span class="line"></span><br><span class="line">&apos;org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl&apos; could not be instantiated</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.logDeserializeError(JavaDeserializer.java:167)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer$ObjectFieldDeserializer.deserialize</span><br><span class="line"></span><br><span class="line">(JavaDeserializer.java:408)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.readObject(JavaDeserializer.java:273)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.readObject(JavaDeserializer.java:200)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.SerializerFactory.readObject(SerializerFactory.java:525)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObjectInstance(Hessian2Input.java:2791)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2731)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2260)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2705)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2260)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.CollectionDeserializer.readLengthList</span><br><span class="line"></span><br><span class="line">(CollectionDeserializer.java:119)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2186)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2057)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer$ObjectFieldDeserializer.deserialize</span><br><span class="line"></span><br><span class="line">(JavaDeserializer.java:404)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.readObject(JavaDeserializer.java:273)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.readObject(JavaDeserializer.java:200)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.SerializerFactory.readObject(SerializerFactory.java:525)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObjectInstance(Hessian2Input.java:2791)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2731)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2260)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2705)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2260)</span><br><span class="line">	at com.alibaba.dubbo.common.serialize.hessian2.Hessian2ObjectInput.readObject</span><br><span class="line"></span><br><span class="line">(Hessian2ObjectInput.java:74)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.dubbo.DecodeableRpcResult.decode(DecodeableRpcResult.java:90)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.dubbo.DecodeableRpcResult.decode(DecodeableRpcResult.java:110)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.dubbo.DubboCodec.decodeBody(DubboCodec.java:88)</span><br><span class="line">	at com.alibaba.dubbo.remoting.exchange.codec.ExchangeCodec.decode(ExchangeCodec.java:121)</span><br><span class="line">	at com.alibaba.dubbo.remoting.exchange.codec.ExchangeCodec.decode(ExchangeCodec.java:82)</span><br><span class="line">	at com.alibaba.dubbo.rpc.protocol.dubbo.DubboCountCodec.decode(DubboCountCodec.java:44)</span><br><span class="line">	at com.alibaba.dubbo.remoting.transport.netty.NettyCodecAdapter$InternalDecoder.messageReceived</span><br><span class="line"></span><br><span class="line">(NettyCodecAdapter.java:133)</span><br><span class="line">	at org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream</span><br><span class="line"></span><br><span class="line">(SimpleChannelUpstreamHandler.java:70)</span><br><span class="line">	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:564)</span><br><span class="line">	at org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:559)</span><br><span class="line">	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)</span><br><span class="line">	at org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)</span><br><span class="line">	at org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:88)</span><br><span class="line">	at org.jboss.netty.channel.socket.nio.AbstractNioWorker.process(AbstractNioWorker.java:109)</span><br><span class="line">	at org.jboss.netty.channel.socket.nio.AbstractNioSelector.run(AbstractNioSelector.java:312)</span><br><span class="line">	at org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:90)</span><br><span class="line">	at org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:178)</span><br><span class="line">	at org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:108)</span><br><span class="line">	at org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)</span><br><span class="line">	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:744)</span><br><span class="line">Caused by: com.alibaba.com.caucho.hessian.io.HessianProtocolException: </span><br><span class="line"></span><br><span class="line">&apos;org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl&apos; could not be instantiated</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.instantiate(JavaDeserializer.java:313)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.readObject(JavaDeserializer.java:198)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObjectInstance(Hessian2Input.java:2789)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2128)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2057)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2101)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.Hessian2Input.readObject(Hessian2Input.java:2057)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer$ObjectFieldDeserializer.deserialize</span><br><span class="line"></span><br><span class="line">(JavaDeserializer.java:404)</span><br><span class="line">	... 43 more</span><br><span class="line">Caused by: java.lang.reflect.InvocationTargetException</span><br><span class="line">	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</span><br><span class="line">	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)</span><br><span class="line">	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</span><br><span class="line">	at java.lang.reflect.Constructor.newInstance(Constructor.java:526)</span><br><span class="line">	at com.alibaba.com.caucho.hessian.io.JavaDeserializer.instantiate(JavaDeserializer.java:309)</span><br><span class="line">	... 50 more</span><br><span class="line">Caused by: java.lang.NullPointerException</span><br><span class="line">	at org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl.&lt;init&gt;</span><br><span class="line"></span><br><span class="line">(ConstraintDescriptorImpl.java:158)</span><br><span class="line">	at org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl.&lt;init&gt;</span><br><span class="line"></span><br><span class="line">(ConstraintDescriptorImpl.java:211)</span><br><span class="line">	... 55 more</span><br></pre></td></tr></table></figure>
<h1 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h1><p>上面的问题从异常面来看已经很直观了，<code>&#39;org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl&#39; could not be instantiated</code>，这个类无法实例化，那是什么原因导致它无法实例化呢？</p>
<p><code>Dubbo</code>的序列化协议，默认是<code>hessian</code>，如果没有进行其他协议配置的话，默认使用的就是<code>hessian</code>，<code>hessian</code>在反序列化时有个特点需要注意一下，它会在反序列化时取<span style="color:red"><strong>参数最少的构造器来创建对象</strong></span>，有的时候会有很多重载的构造器，因此会有一些参数直接给<code>null</code>，因此可能就会造成一些莫名其妙的问题，就像我们这个问题一样。</p>
<p>那这个问题如何解决呢？接着往下看</p>
<h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><p>由于这个是<code>Hessian</code>反序列化问题，因此与<code>Dubbo</code>的版本关系不大，为了验证这个我还专门使用<code>apache dubbo</code> <code>2.6.1</code>版本测试了一下，问题依旧存在。</p>
<h2 id="方法一：使用无参构造方法来创建对象"><a href="#方法一：使用无参构造方法来创建对象" class="headerlink" title="方法一：使用无参构造方法来创建对象"></a>方法一：使用无参构造方法来创建对象</h2><p>既然是<code>hessian</code>反序列化问题，而且它在反序列化时根据构造函数参数个数优先级来取参数最少的，那我们就可以增加一个<span style="color:red"><strong>无参的构造方法</strong></span>来解决这个问题。</p>
<p>但是有的时候我们使用的是第三方的包，不太好增加无参的构造方法，那怎么办的，我们能不能使用其他方法，继续往下看。</p>
<h2 id="方法二：替换jsr303实现框架"><a href="#方法二：替换jsr303实现框架" class="headerlink" title="方法二：替换jsr303实现框架"></a>方法二：替换jsr303实现框架</h2><p>既然<code>hibernate-validator</code>的<code>org.hibernate.validator.internal.metadata.descriptor.ConstraintDescriptorImpl</code>这个类在使用hessian反序列化存在问题，那我们使用其他jsr303的框架来试试。</p>
<p>jsr303的实现框架有哪些？</p>
<ul>
<li>org.hibernate : hibernate-validator : 5.2.4.Final</li>
<li>org.apache.bval : bval-jsr303 : 0.5</li>
<li>jersery</li>
</ul>
<p>bval是apache的一个bean validator的实现，jersery是一个restful的框架为了满足自身的数据验证功能因此增加了jsr303的实现。</p>
<p>由于我们使用的springmvc构建restful因此这里就不考虑jersery，我们就从bval下手来试一试。</p>
<p>在进行了一番配置后（都有哪些配置？）</p>
<ul>
<li>增加bval包，现在版本是：0.5</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.apache.bval&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;bval-jsr303&lt;/artifactId&gt;</span><br><span class="line">	&lt;version&gt;0.5&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>将bval集成到spring框架中，作为spring的验证框架</li>
</ul>
<p>这里有两种方式，一种xml配置，一种java config</p>
<p>xml方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;mvc:annotation-driven validator=&quot;validator&quot;/&gt;  </span><br><span class="line">  </span><br><span class="line">&lt;!-- 数据验证 Validator bean --&gt;  </span><br><span class="line">&lt;bean id=&quot;validator&quot; class=&quot;org.springframework.validation.beanvalidation.LocalValidatorFactoryBean&quot;&gt;  </span><br><span class="line">    &lt;property name=&quot;providerClass&quot; value=&quot;org.apache.bval.jsr.ApacheValidationProvider&quot; /&gt;  </span><br><span class="line">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>java config方式:<br>重写mvcValidator方法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Validator mvcValidator() &#123;</span><br><span class="line">    Validator validator = super.mvcValidator();</span><br><span class="line">    if (validator instanceof LocalValidatorFactoryBean) &#123;</span><br><span class="line">        LocalValidatorFactoryBean lvfb = (LocalValidatorFactoryBean) validator;</span><br><span class="line">        try &#123;</span><br><span class="line">            String className = &quot;org.apache.bval.jsr303.ApacheValidationProvider&quot;;</span><br><span class="line">            Class&lt;?&gt; clazz = ClassUtils.forName(className, WebMvcConfigurationSupport.class.getClassLoader());</span><br><span class="line">            lvfb.setProviderClass(clazz);</span><br><span class="line">        &#125;</span><br><span class="line">        catch (ClassNotFoundException e) &#123;</span><br><span class="line">            //没有找到bval验证框架，走spring默认整合的验证框架：hibernate-validator</span><br><span class="line">            //这里异常没有必要跑出去，直接吃掉</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return validator;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>启动后验证功能</p>
<p>但是不好的事情发生了，无法启动报错，错误如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">java.lang.AbstractMethodError: org.apache.bval.jsr303.ConfigurationImpl.getDefaultParameterNameProvider()</span><br><span class="line"></span><br><span class="line">Ljavax/validation/ParameterNameProvider;</span><br></pre></td></tr></table></figure>
<p>经过对<code>spring</code>的资料查找，发现<code>spring</code>从4.0版本往后不在支持集成其他jsr303的框架了，只能使用<code>hibernate-validator</code>，我擦这个有点暴力了。即使自己实现一个jsr303框架也无法再<code>spring</code>中使用，除非不使用<code>spring</code> <code>validator</code>功能，直接使用自己的验证框架来进行验证，这样就无法使用<code>@Validated param</code>方式。</p>
<p>那这种方法只能放弃了。</p>
<h2 id="方法三：修改hibernate-validator的原声类，修改Dubbo-ValidationFilter，这也是我最终采用的方法"><a href="#方法三：修改hibernate-validator的原声类，修改Dubbo-ValidationFilter，这也是我最终采用的方法" class="headerlink" title="方法三：修改hibernate-validator的原声类，修改Dubbo ValidationFilter，这也是我最终采用的方法"></a>方法三：修改hibernate-validator的原声类，修改Dubbo ValidationFilter，这也是我最终采用的方法</h2><p>其实替换jsr303框架不能成功，替换序列化协议应该也可以避免这个问题，只不过替换协议这个一般在维护的项目中不太会选择这样的方式来动刀子，现在开发很多都是分布式服务，序列化反序列化已经无处不在了，因此我建议编写代码时都增加一个无参数的构造方法，养成这样的一个好习惯可以避免很多序列化反序列化框架的坑。而且还有那些有匿名内部类的这种在序列化反序列化也需要注意，不是所有的序列化反序列化框架都支持有匿名类，gson是支持的这个为测试过，我前面也写过一篇博文里面就主要说这个问题，可以查看：<a href="https://ningyu1.github.io/site/post/65-java-inner-class/">《Java中内部类使用注意事项，内部类对序列化与反序列化的影响》</a></p>
<p>有兴趣的可以看一下我们常用的序列化反序列化类库的一些使用中的注意事项，可以参考这篇文章：<a href="https://blog.fliaping.com/the-attention-of-json-serialization-and-deserialization-in-java/" target="_blank" rel="noopener">《java常用JSON库注意事项总结》</a></p>
<p>回归话题，上面的问题我们如何解决，最终我们采用重写<code>javax.validation.ConstraintViolation&lt;T&gt;</code>的实现类，替换掉<code>hibernate-validation</code>的<code>org.hibernate.validator.internal.engine.ConstraintViolationImpl</code>，因为<code>ConstraintViolationImpl</code>中有部分对象无法通过hessian反序列化。</p>
<p>我们最终的目标是不管是validation开启在provider端还是consumer端，调用方接收到的参数校验异常数据是一致的。</p>
<p>修改的代码已经提交到<code>apache dubbo</code>，具体查看Pull request：<a href="https://github.com/apache/incubator-dubbo/pull/1708" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo/pull/1708</a></p>
<p>大概的代码如下：</p>
<h3 id="增加类：DubboConstraintViolation实现javax-validation-ConstraintViolation接口"><a href="#增加类：DubboConstraintViolation实现javax-validation-ConstraintViolation接口" class="headerlink" title="增加类：DubboConstraintViolation实现javax.validation.ConstraintViolation接口"></a>增加类：DubboConstraintViolation实现<code>javax.validation.ConstraintViolation</code>接口</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import java.io.Serializable;</span><br><span class="line">import javax.validation.ConstraintViolation;</span><br><span class="line">import javax.validation.Path;</span><br><span class="line">import javax.validation.ValidationException;</span><br><span class="line">import javax.validation.metadata.ConstraintDescriptor;</span><br><span class="line">import com.alibaba.dubbo.common.logger.Logger;</span><br><span class="line">import com.alibaba.dubbo.common.logger.LoggerFactory;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class DubboConstraintViolation&lt;T&gt; implements ConstraintViolation&lt;T&gt;, Serializable &#123;</span><br><span class="line">    </span><br><span class="line">    static final Logger logger = LoggerFactory.getLogger(DubboConstraintViolation.class.getName());</span><br><span class="line"></span><br><span class="line">	private static final long serialVersionUID = -8901791810611051795L;</span><br><span class="line"></span><br><span class="line">	private String interpolatedMessage;</span><br><span class="line">    private Object value;</span><br><span class="line">    private Path propertyPath;</span><br><span class="line">    private String messageTemplate;</span><br><span class="line">    private Object[] executableParameters;</span><br><span class="line">    private Object executableReturnValue;</span><br><span class="line">    private int hashCode;</span><br><span class="line"></span><br><span class="line">    public DubboConstraintViolation() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public DubboConstraintViolation(ConstraintViolation&lt;T&gt; violation) &#123;</span><br><span class="line">        this(violation.getMessageTemplate(), violation.getMessage(), violation.getInvalidValue(), violation.getPropertyPath(),</span><br><span class="line">                violation.getExecutableParameters(), violation.getExecutableReturnValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public DubboConstraintViolation(String messageTemplate,</span><br><span class="line">            String interpolatedMessage,</span><br><span class="line">            Object value,</span><br><span class="line">            Path propertyPath,</span><br><span class="line">            Object[] executableParameters,</span><br><span class="line">            Object executableReturnValue) &#123;</span><br><span class="line">        this.messageTemplate = messageTemplate;</span><br><span class="line">        this.interpolatedMessage = interpolatedMessage;</span><br><span class="line">        this.value = value;</span><br><span class="line">        this.propertyPath = propertyPath;</span><br><span class="line">        this.executableParameters = executableParameters;</span><br><span class="line">        this.executableReturnValue = executableReturnValue;</span><br><span class="line">        // pre-calculate hash code, the class is immutable and hashCode is needed often</span><br><span class="line">        this.hashCode = createHashCode();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    @Override</span><br><span class="line">    public final String getMessage() &#123;</span><br><span class="line">        return interpolatedMessage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final String getMessageTemplate() &#123;</span><br><span class="line">        return messageTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final T getRootBean() &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final Class&lt;T&gt; getRootBeanClass() &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final Object getLeafBean() &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final Object getInvalidValue() &#123;</span><br><span class="line">        return value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final Path getPropertyPath() &#123;</span><br><span class="line">        return propertyPath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public final ConstraintDescriptor&lt;?&gt; getConstraintDescriptor() &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public &lt;C&gt; C unwrap(Class&lt;C&gt; type) &#123;</span><br><span class="line">        if ( type.isAssignableFrom( ConstraintViolation.class ) ) &#123;</span><br><span class="line">            return type.cast( this );</span><br><span class="line">        &#125;</span><br><span class="line">        throw new ValidationException(&quot;Type &quot; + type.toString() + &quot; not supported for unwrapping.&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object[] getExecutableParameters() &#123;</span><br><span class="line">        return executableParameters;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Object getExecutableReturnValue() &#123;</span><br><span class="line">        return executableReturnValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    // IMPORTANT - some behaviour of Validator depends on the correct implementation of this equals method! (HF)</span><br><span class="line"></span><br><span class="line">    // Do not take expressionVariables into account here. If everything else matches, the two CV should be considered</span><br><span class="line">    // equals (and because of the scary comment above). After all, expressionVariables is just a hint about how we got</span><br><span class="line">    // to the actual CV. (NF)</span><br><span class="line">    public boolean equals(Object o) &#123;</span><br><span class="line">        if ( this == o ) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( o == null || getClass() != o.getClass() ) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        DubboConstraintViolation&lt;?&gt; that = (DubboConstraintViolation&lt;?&gt;) o;</span><br><span class="line"></span><br><span class="line">        if ( interpolatedMessage != null ? !interpolatedMessage.equals( that.interpolatedMessage ) : that.interpolatedMessage != null ) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( propertyPath != null ? !propertyPath.equals( that.propertyPath ) : that.propertyPath != null ) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( messageTemplate != null ? !messageTemplate.equals( that.messageTemplate ) : that.messageTemplate != null ) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if ( value != null ? !value.equals( that.value ) : that.value != null ) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int hashCode() &#123;</span><br><span class="line">        return hashCode;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        final StringBuilder sb = new StringBuilder();</span><br><span class="line">        sb.append( &quot;DubboConstraintViolation&quot; );</span><br><span class="line">        sb.append( &quot;&#123;interpolatedMessage=&apos;&quot; ).append( interpolatedMessage ).append( &apos;\&apos;&apos; );</span><br><span class="line">        sb.append( &quot;, propertyPath=&quot; ).append( propertyPath );</span><br><span class="line">        sb.append( &quot;, messageTemplate=&apos;&quot; ).append( messageTemplate ).append( &apos;\&apos;&apos; );</span><br><span class="line">        sb.append( &quot;, value=&apos;&quot; ).append( value ).append( &apos;\&apos;&apos; );</span><br><span class="line">        sb.append( &apos;&#125;&apos; );</span><br><span class="line">        return sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Same as for equals, do not take expressionVariables into account here.</span><br><span class="line">    private int createHashCode() &#123;</span><br><span class="line">        int result = interpolatedMessage != null ? interpolatedMessage.hashCode() : 0;</span><br><span class="line">        result = 31 * result + ( propertyPath != null ? propertyPath.hashCode() : 0 );</span><br><span class="line">        result = 31 * result + ( value != null ? value.hashCode() : 0 );</span><br><span class="line">        result = 31 * result + ( messageTemplate != null ? messageTemplate.hashCode() : 0 );</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="修改com-alibaba-dubbo-validation-filter-ValidationFilter异常处理的部分"><a href="#修改com-alibaba-dubbo-validation-filter-ValidationFilter异常处理的部分" class="headerlink" title="修改com.alibaba.dubbo.validation.filter.ValidationFilter异常处理的部分"></a>修改<code>com.alibaba.dubbo.validation.filter.ValidationFilter</code>异常处理的部分</h3><p>这里的变更为捕捉<code>javax.validation.ConstraintViolationException</code>异常，对异常中的<code>Set&lt;ConstraintViolation&lt;String&gt;&gt;</code>数据进行转换，去掉无法反序列化的对象,具体代码如下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) throws RpcException &#123;</span><br><span class="line">    if (validation != null &amp;&amp; !invocation.getMethodName().startsWith(&quot;$&quot;)</span><br><span class="line">            &amp;&amp; ConfigUtils.isNotEmpty(invoker.getUrl().getMethodParameter(invocation.getMethodName(), Constants.VALIDATION_KEY))) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            Validator validator = validation.getValidator(invoker.getUrl());</span><br><span class="line">            if (validator != null) &#123;</span><br><span class="line">                validator.validate(invocation.getMethodName(), invocation.getParameterTypes(), invocation.getArguments());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (ConstraintViolationException e) &#123;</span><br><span class="line">            Set&lt;ConstraintViolation&lt;?&gt;&gt; set = null;</span><br><span class="line">            //验证set中如果是hibernate-validation实现的类就处理，其他的实现类放过</span><br><span class="line">            Set&lt;ConstraintViolation&lt;?&gt;&gt; constraintViolations = e.getConstraintViolations();</span><br><span class="line">            for (ConstraintViolation&lt;?&gt; v : constraintViolations) &#123;</span><br><span class="line">                if (!v.getClass().getName().equals(&quot;org.hibernate.validator.internal.engine.ConstraintViolationImpl&quot;)) &#123;</span><br><span class="line">                    return new RpcResult(e);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    if (set == null) set = new HashSet&lt;ConstraintViolation&lt;?&gt;&gt;();</span><br><span class="line">                    set.add(new DubboConstraintViolation&lt;&gt;(v));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return new RpcResult(new ConstraintViolationException(e.getMessage(), set));</span><br><span class="line">        &#125; catch (RpcException e) &#123;</span><br><span class="line">            throw e;</span><br><span class="line">        &#125; catch (Throwable t) &#123;</span><br><span class="line">            return new RpcResult(t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return invoker.invoke(invocation);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用这个方法后，在<code>provider</code>端设置<code>validation=true</code>，<code>consumer</code>端可以正常拿到所有校验数据的异常信息。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>我觉得这个方法并不是完美的方法，虽然这个问题是<code>hibernate-validator</code>框架的问题，<code>hibernate-validator</code>出生的年代分布式还不是特别的完善因此没有充分的考虑序列化反序列化问题也很正常，但是作为<code>Dubbo</code>框架在集成<code>jsr303</code>的时候也需要考虑这些问题。具体可以查看<code>Apache Dubbo</code>的<code>Pull Request</code>：<a href="https://github.com/apache/incubator-dubbo/pull/1708" target="_blank" rel="noopener">https://github.com/apache/incubator-dubbo/pull/1708</a></p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2024-04-23T01:48:15.037Z" itemprop="dateUpdated">2024-04-23 09:48:15</time>
</span><br>


        
        原始链接：<a href="/20180423/78-dubbo-validation-jsr303-pit.html" target="_blank" rel="external">https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html</a><br>版权声明：本文由 <strong>凝雨-Yun</strong> 原创，采用<strong><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a></strong>进行许可。 <br><strong>转载请注明作者及出处！</strong><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>
        
    </div>
    
    <footer>
        <a href="https://ningyu1.github.io">
            <img src="/img/avatar.jpg" alt="凝雨">
            凝雨
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hibernate-validator/">hibernate-validator</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jsr303/">jsr303</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&title=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&pic=https://ningyu1.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&title=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&source=快乐编程每一天 - Happy Coding Every Day" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&via=https://ningyu1.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/20180427/79-docker-registry-pull-filesystem-layer.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Trouble Shooting —— Docker Pull Image : Filesystem layer verification failed for digest sha256错误</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/20180412/77-jenkins-sonarqube-jacoco-junit.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">单元测试以及代码覆盖率——Jenkins集成SonarQube、JaCoCo、Junit使用问题汇总</h4>
      </a>
    </div>
  
</nav>



    

















<section class="comments" id="comments">
    <div id="gitalk-container"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
        var id = location.pathname
        if (location.pathname.length > 50) {
          id = location.pathname.replace(/\/\d+\/\d+\/\d+\//, '').replace('/', '').substring(0, 50)
        }
        const gitalk = new Gitalk({
          clientID: '298f0d78bd14c9c0ff01',
          clientSecret: 'e81e4d36caf1a13d2f05ed5dcf30e636dde749ac',
          repo: 'blog',
          owner: 'ningyu1',
          admin: ['ningyu1'],
          id: id,      // Ensure uniqueness and length less than 50
	  //id: 'Comments',
          title: document.title.split('|')[0],
          distractionFreeMode: false  // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    </script>
</section>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        可以吃个鸡腿吗？
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.jpg" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/deed.zh">知识共享署名-相同方式共享 4.0 国际许可协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>凝雨 &copy; 2016 - 2024</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&title=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&pic=https://ningyu1.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&title=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&source=快乐编程每一天 - Happy Coding Every Day" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Dubbo使用jsr303框架hibernate-validator遇到的问题》 — 凝雨 - Yun&url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html&via=https://ningyu1.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://ningyu1.github.io/20180423/78-dubbo-validation-jsr303-pit.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACuElEQVR42u3aQY7cMAwEwPz/0xsg1814uklpMwjKp2DWsFU+SEyTv37F19ef6/sv33+fPeH5evWEYxceHh7eaOn5o18tNGfnT3hez/M9eHh4eLd5z4tIlpts/fnnaD/xy9/x8PDw/invzRb8SGoLcTw8PLz/g5ds5S2mLZ3x8PDwPoeXvyYPYWd3ztgHshY8PDy8mNe2rz7h3xf7e3h4eHiLrnobQORhRBtbDNeJh4eHd4F3dnwqB7RRb1LcF3kwHh4e3oKXN6Jmm3X7KWef4+Wa8fDw8C7wkog2f0E7LpA0xvKhhKgBhoeHh3eU14a2eRGcLzcfNSiCXTw8PLwLvJydvGAW3ebHUvJkPDw8vHu8WeSaD061UUIeUkSHGR4eHt4F3qZUzeOA2XmVfOIDU2N4eHh4JW+2EbeN/PZQyf8fEM1E4OHh4R3lzQKCdnyqfdesJfYmksDDw8M7xNsMOW2i2JY3DHzx8PDwLvP2g1OnCuW8Qn4To+Dh4eFd4LXV96nCdxZ5tGw8PDy8e7z2YLjxIfKiuU1r8fDw8G7wZiVsgmnv2QcZeHh4eD/Daxta+SjAass+G0Pg4eHhHeVttuPk/jzq3ZfXbyIJPDw8vGu8/SZ+Kop9fkJ+OOHh4eGd5bVDV218kEeu+aafj4Lh4eHh3eDlL55Ft5uhrrzgrvMMPDw8vAUvPwbarb89SJJYuQ4j8PDw8K7xkqZ+3vjPS/DZUZGvBw8PD+8s76u89vh8WCEfQXi5Njw8PLwLvFOtrFmrLCmsZ2X34U4dHh4eXjw0kJOSv+6bYfkgV1FY4+Hh4S14s7ZTHq3OIt1N0w4PDw/vc3ibcGF22AwHVfHw8PA+gDdDbkLY/DPh4eHh/TwvCSPaIYAkMmg3/TqNxsPDw7vAmzXA2mbV7GO1Ecmx/h4eHh7e35/5G3opAydpFhnnAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-indigo-patch@1.0.0/source/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>










</body>
</html>
