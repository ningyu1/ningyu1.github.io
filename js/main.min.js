!function(a,b){var y,z,c=b.body,d=b.querySelector.bind(b),e=b.querySelectorAll.bind(b),f=d("html"),g=d("#gotop"),h=d("#menu"),k=d("#header"),l=d("#mask"),m=d("#menu-toggle"),n=d("#menu-off"),o=d("#loading"),p=a.requestAnimationFrame,q=12,r=Array.prototype.forEach,s="ontouchstart"in a&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",t=/micromessenger/i.test(navigator.userAgent),u=function(){},v=function(a){var d,b=a.offsetLeft,c=a.offsetTop;return a.offsetParent&&(d=arguments.callee(a.offsetParent),b+=d.x,c+=d.y),{x:b,y:c}},w=function(){return b.documentElement.scrollTop||b.body.scrollTop},x={goTop:function(b){var c=w(),d=arguments.length>2?arguments[1]:Math.abs(c-b)/q;c&&c>b?(a.scrollTo(0,Math.max(c-d,0)),p(arguments.callee.bind(this,b,d))):b&&b>c?(a.scrollTo(0,Math.min(c+d,b)),p(arguments.callee.bind(this,b,d))):this.toc.actived(b)},toggleGotop:function(b){b>a.innerHeight/2?g.classList.add("in"):g.classList.remove("in")},toggleMenu:function(b){var e,c=d("#main");b?(h.classList.remove("hide"),a.innerWidth<1241&&(l.classList.add("in"),h.classList.add("show"),t?(e=w(),c.classList.add("lock"),c.scrollTop=e):f.classList.add("lock"))):(h.classList.remove("show"),l.classList.remove("in"),t?(e=c.scrollTop,c.classList.remove("lock"),a.scrollTo(0,e)):f.classList.remove("lock"))},fixedHeader:function(a){a>k.clientHeight?k.classList.add("fixed"):k.classList.remove("fixed")},toc:function(){var b,c,e,f,g,h,a=d("#post-toc");if(!a||!a.children.length)return{fixed:u,actived:u};for(b=d(".post-header").clientHeight,c=k.clientHeight,e=d("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6"),a.querySelector('a[href="#'+e[0].id+'"]').parentNode.classList.add("active"),f=a.querySelectorAll(".post-toc-child"),i=0,len=f.length;len>i;i++)f[i].classList.add("post-toc-shrink");return g=a.querySelector('a[href="#'+e[0].id+'"]').nextElementSibling,g&&(g.classList.add("post-toc-expand"),g.classList.remove("post-toc-shrink")),a.classList.remove("post-toc-shrink"),h=function(a,b){var c,d;for(a.classList.remove("active"),b.classList.add("active"),c=b.parentElement.querySelectorAll(".post-toc-child"),j=0,len1=c.length;len1>j;j++)c[j].classList.remove("post-toc-expand"),c[j].classList.add("post-toc-shrink");d=b.querySelector(".post-toc-child"),d&&(d.classList.remove("post-toc-shrink"),d.classList.add("post-toc-expand"))},{fixed:function(d){d>=b-c?a.classList.add("fixed"):a.classList.remove("fixed")},actived:function(b){var d,f;for(i=0,len=e.length;len>i;i++)b>v(e[i]).y-c-5&&(d=a.querySelector("li.active"),f=a.querySelector('a[href="#'+e[i].id+'"]').parentNode,h(d,f));b<v(e[0]).y&&h(a.querySelector("li.active"),a.querySelector('a[href="#'+e[0].id+'"]').parentNode)}}}(),hideOnMask:[],modal:function(a){this.$modal=d(a),this.$off=this.$modal.querySelector(".close");var b=this;this.show=function(){l.classList.add("in"),b.$modal.classList.add("ready"),setTimeout(function(){b.$modal.classList.add("in")},0)},this.onHide=u,this.hide=function(){b.onHide(),l.classList.remove("in"),b.$modal.classList.remove("in"),setTimeout(function(){b.$modal.classList.remove("ready")},300)},this.toggle=function(){return b.$modal.classList.contains("in")?b.hide():b.show()},x.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener(s,this.hide)},share:function(){var g,a=d("#pageShare"),c=d("#shareFab"),f=new this.modal("#globalShare");d("#menuShare").addEventListener(s,f.toggle),c&&(c.addEventListener(s,function(){a.classList.toggle("in")},!1),b.addEventListener(s,function(b){!c.contains(b.target)&&a.classList.remove("in")},!1)),g=new this.modal("#wxShare"),g.onHide=f.hide,r.call(e(".wxFab"),function(a){a.addEventListener(s,g.toggle)})},search:function(){function b(){a.classList.toggle("in")}var a=d("#search-wrap");d("#search").addEventListener(s,b)},reward:function(){var b,c,a=new this.modal("#reward");d("#rewardBtn").addEventListener(s,function(){l.parentNode.appendChild(d("#reward")),a.toggle()}),b=d("#rewardToggle"),c=d("#rewardCode"),b&&b.addEventListener("change",function(){c.src=this.checked?this.dataset.alipay:this.dataset.wechat})},waterfall:function(){a.innerWidth<760||r.call(e(".waterfall"),function(a){var b=a.querySelectorAll(".waterfall-item"),c=[0,0];r.call(b,function(a){var b=c[0]<=c[1]?0:1;a.style.cssText="top:"+c[b]+"px;left:"+(b>0?"50%":0),c[b]+=a.offsetHeight}),a.style.height=Math.max(c[0],c[1])+"px",a.classList.add("in")})},tabBar:function(a){a.parentNode.parentNode.classList.toggle("expand")},page:function(){var a=e(".fade, .fade-scale"),b=!1;return{loaded:function(){r.call(a,function(a){a.classList.add("in")}),b=!0},unload:function(){r.call(a,function(a){a.classList.remove("in")}),b=!1},visible:b}}(),lightbox:function(){function d(d){var e,f,g,h,i,j;this.$img=d.querySelector("img"),this.$overlay=d.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1,this.calcRect=function(){var a,b,d,l,m,n;return h=c.clientWidth,i=c.clientHeight,a=i-2*this.margin,b=e,d=f,this.margin,l=b>h?h/b:1,m=d>a?a/d:1,n=Math.min(l,m),b*=n,d*=n,{w:b,h:d,t:(i-d)/2-g.top,l:(h-b)/2-g.left+this.$img.offsetLeft}},this.setImgRect=function(a){this.$img.style.cssText="width: "+a.w+"px; max-width: "+a.w+"px; height:"+a.h+"px; top: "+a.t+"px; left: "+a.l+"px"},this.setFrom=function(){this.setImgRect({w:g.width,h:g.height,t:0,l:(d.offsetWidth-g.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=b.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",d.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&d.removeChild(this.$caption)},j=this,this.zoomIn=function(){e=this.$img.naturalWidth||this.$img.width,f=this.$img.naturalHeight||this.$img.height,g=this.$img.getBoundingClientRect(),d.style.height=g.height+"px",d.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout(function(){d.classList.add("active"),j.setTo(),j.isZoom=!0},0)},this.zoomOut=function(){this.isZoom=!1,d.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout(function(){j.$img.classList.remove("zoom-in"),j.$img.style.cssText="",j.removeTitle(),d.classList.remove("ready"),d.removeAttribute("style")},300)},d.addEventListener("click",function(a){j.isZoom?j.zoomOut():"IMG"===a.target.tagName&&j.zoomIn()}),b.addEventListener("scroll",function(){j.isZoom&&j.zoomOut()}),a.addEventListener("resize",function(){j.isZoom&&j.zoomOut()})}r.call(e(".img-lightbox"),function(a){new d(a)})}(),loadScript:function(a){a.forEach(function(a){var d=b.createElement("script");d.src=a,d.async=!0,c.appendChild(d)})}};a.addEventListener("load",function(){o.classList.remove("active"),x.page.loaded(),a.lazyScripts&&a.lazyScripts.length&&x.loadScript(a.lazyScripts)}),a.addEventListener("DOMContentLoaded",function(){x.waterfall();var a=w();x.toc.fixed(a),x.toc.actived(a),x.page.loaded()}),y=!1,z=d('a[href^="mailto"]'),z&&z.addEventListener(s,function(){y=!0}),a.addEventListener("beforeunload",function(){y?y=!1:x.page.unload()}),a.addEventListener("pageshow",function(){!x.page.visible&&x.page.loaded()}),a.addEventListener("resize",function(){a.BLOG.even=s="ontouchstart"in a?"touchstart":"click",x.toggleMenu(),x.waterfall()}),g.addEventListener(s,function(){p(x.goTop.bind(x,0))},!1),m.addEventListener(s,function(a){x.toggleMenu(!0),a.preventDefault()},!1),n.addEventListener(s,function(){h.classList.add("hide")},!1),l.addEventListener(s,function(a){x.toggleMenu(),x.hideOnMask.forEach(function(a){a()}),a.preventDefault()},!1),b.addEventListener("scroll",function(){var a=w();x.toggleGotop(a),x.fixedHeader(a),x.toc.fixed(a),x.toc.actived(a)},!1),a.BLOG.SHARE&&x.share(),a.BLOG.REWARD&&x.reward(),x.noop=u,x.even=s,x.$=d,x.$$=e,Object.keys(x).reduce(function(a,b){return a[b]=x[b],a},a.BLOG),a.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")}(window,document);